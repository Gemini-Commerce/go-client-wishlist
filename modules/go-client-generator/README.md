# Gemini PHP Client Generator

Base Makefile to generate Gemini's service PHP Client based on OpenAPI Specification (OAS).
This module should be integrated as git submodule inside service's client repository.

The PHP client is autogenerated thanks to a docker image provided by OpenAPITools named
[openapitools/openapi-generator-cli](https://github.com/OpenAPITools/openapi-generator) and swagger.json file that
contains OpenAPI definitions present in service proto folder.

For more information about service OpenAPI definitions visit:

- [Proto repository](https://bitbucket.org/gogemini/proto/src/master/)
- [OpenAPI Definitions examples for ProtoBuf](https://bitbucket.org/gogemini/examples/src/master/OpenAPI/)

### Usage

1. create service specific repository
2. Include this repo as git submodule
3. execute command:

```
make $(MAKE) -C ./modules/php-client-generator/ generate-php-client service=${search} version=${version}
```

### How to make a custom template for code and doc generation

OpenAPI Generator uses template to generate code and doc for client, if you want to personalize code or doc using a
custom template, follow this steps:

1. Go to [openapi-generator GitHub](https://github.com/OpenAPITools/openapi-generator), and download in a local folder
   the project
2. Open the project and go to src/main/resources/php, here you can find the standard template for code and doc
   autogenerate. Autogenerate templates for doc are identified by _doc in file name, others are for code generator. Copy
   the template that you want to edit, in templates/php folder of php-client project
3. Open the project and edit the template as you want, to get all available variable in a template, you can simply put
   {{.}}, templates uses mustache templates system, for more information visit
   [Mustache Documentation](https://mustache.github.io/mustache.5.html)

### Usage Warnings:

- Actually for the php-client makefile generation task, the openapi-generator is locked to use 5.2.9 version. This is
  due to the upgrade of Guzzle from 6.3 to 7 occurred in version 5.3.0 that can cause conflicts with some Magento
  components, if you want to update the generator at your risk you can change the generator version to use in makefile,
  or make your own makefile task.

### Known Bugs [In version 5.2.9]:

- Description of enum fields are not correctly reported in documentations, actually here is a custom template in
  templates/php that replace empty enum field description with the message
  "For more information please, see Model/[ModelFileName]"

- Sometimes required field are not reported correctly to autogenerated documentation, actually we simply add the string
  "[#DOCGENBUG REQUIRED FIELD]" to the required field that are reported wrongly as optional"

Remember to remove this section if you upgrade OpenAPI generator and indicated bugs are fixed!
